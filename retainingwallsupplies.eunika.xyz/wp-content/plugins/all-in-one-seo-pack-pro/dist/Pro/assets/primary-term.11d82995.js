import{y as m,o as _,d as w,e as p,t as l,H as c,w as u,a as P,b as v,Y as b}from"./js/runtime-dom.esm-bundler.d8b05b6d.js";import{l as E}from"./js/index.1e409735.js";import{a as B,l as $}from"./js/index.42716f2e.js";import{l as k}from"./js/index.d80c2c2c.js";import{e as A,i as C,B as N,C as I,l as T}from"./js/index.1e998b9c.js";import{e as L}from"./js/elemLoaded.2921fc72.js";import{s as V}from"./js/metabox.61ec24b3.js";import{g as q,a as H,b as M,t as U,c as F}from"./js/helpers.e885d555.js";import{C as O}from"./js/Tooltip.e34dd010.js";import{w as Q}from"./js/helpers.1548cd59.js";import"./js/translations.d159963e.js";import{_ as x}from"./js/_plugin-vue_export-helper.eefbdd86.js";import{a as z}from"./js/toString.569e8443.js";import{b as K}from"./js/_baseIteratee.66d88037.js";import{b as R}from"./js/_basePickBy.cc0cc8b1.js";import{g as Y}from"./js/_getAllKeysIn.e05390b8.js";import{s as d,_ as y}from"./js/default-i18n.20001971.js";import"./js/Caret.6651fe3d.js";import"./js/_baseIsEqual.cf429ced.js";import"./js/_getTag.bcd028a7.js";import"./js/_baseSet.bcc51cfa.js";function D(e,t){if(e==null)return{};var o=z(Y(e),function(r){return[r]});return t=K(t),R(e,o,function(r,s){return t(r,s[0])})}const f="aioseo-pro",G={setup(){return{postEditorStore:A()}},components:{CoreTooltip:O,SvgCircleQuestionMark:B},props:{taxonomy:String},data(){return{term:null,terms:[],selectedTerms:[]}},watch:{terms(e){if(!this.term&&e&&this.postEditorStore.currentPost.primary_term[this.taxonomy]){const t=e.find(o=>o.value===this.postEditorStore.currentPost.primary_term[this.taxonomy]);this.setPrimaryTerm(t)}},selectedTerms(e,t){if(t.length<e.length){const o=e.filter(r=>!t.includes(r))[0];this.terms.some(r=>r.value===o)||this.updateTerms()}this.term&&this.term.value&&!e.includes(this.term.value)&&this.setPrimaryTerm(null)}},computed:{taxonomyName(){return q(this.taxonomy).singular},toolTipText(){return d(y("%1$s allows you to choose a primary %2$s for your posts. This feature works hand in hand with our powerful Breadcrumbs template to give you full navigational control to help improve your search rankings.",f),"AIOSEO Pro",this.taxonomyName)},labelString(){return d(y("Select Primary %1$s",f),this.taxonomyName)},options(){return this.terms.filter(e=>this.selectedTerms.includes(e.value))}},methods:{setPrimaryTerm(e){this.term=e,window.aioseoBus.$emit("standalone-update-post",{primary_term:D({...this.postEditorStore.currentPost.primary_term,[this.taxonomy]:e&&e.value?e.value:null})})},updateTerms(){H(this.taxonomy).then(e=>{this.terms=[],e.forEach(t=>{this.terms.push({value:t.id,label:Q(t.name)})})})},updateSelectedTerms(){this.selectedTerms=M(this.taxonomy)}},mounted(){this.updateTerms(),this.updateSelectedTerms(),window.aioseoBus.$on("updateSelectedTerms",this.updateSelectedTerms)},beforeUnmount(){window.aioseoBus.$off("updateSelectedTerms",this.updateSelectedTerms)}},J={key:0,class:"aioseo-primary-term-select"},W={class:"aioseo-primary-term-select__title"},X={class:"aioseo-primary-term-select__title-text"};function Z(e,t,o,r,s,i){const a=m("svg-circle-question-mark"),n=m("core-tooltip"),g=m("base-select");return 1<s.selectedTerms.length?(_(),w("div",J,[p("div",W,[p("span",X,l(i.labelString),1),c(n,{offset:"-200px,0"},{tooltip:u(()=>[P(l(i.toolTipText),1)]),default:u(()=>[c(a)]),_:1})]),c(g,{size:"medium",options:i.options,modelValue:s.term,"onUpdate:modelValue":t[0]||(t[0]=S=>i.setPrimaryTerm(S))},null,8,["options","modelValue"])])):v("",!0)}const j=x(G,[["render",Z]]),ee={components:{PrimaryTerm:j},props:{taxonomy:String}},te={class:"aioseo-app aioseo-primary-term"};function oe(e,t,o,r,s,i){const a=m("primary-term");return _(),w("div",te,[c(a,{taxonomy:o.taxonomy},null,8,["taxonomy"])])}const re=x(ee,[["render",oe]]);if(C()&&window.wp){const{createElement:e,Fragment:t}=window.wp.element,{addFilter:o}=window.wp.hooks,{createHigherOrderComponent:r}=window.wp.compose,{subscribe:s}=window.wp.data;o("editor.PostTaxonomyType","aioseo/primary-term",r(i=>a=>{const{slug:n}=a;return U(n)?e(t,{},e(i,a),e("div",{id:`aioseo-primary-term-${n}`},e("div",{className:"aioseo-primary-term-app",taxonomy:n}))):e(i,a)},"withInspectorControls")),s(()=>{window.aioseoBus.$emit("updateSelectedTerms")})}(N()||I())&&(T(),F().forEach(e=>{var r;const t=(r=document.getElementById(`${e.name}div`))==null?void 0:r.querySelector(".inside");if(!t)return;const o=document.createElement("div");o.setAttribute("id",`aioseo-primary-term-${e.name}`),o.setAttribute("class","aioseo-primary-term-app"),o.setAttribute("taxonomy",e.name),t.append(o),function(s){s(`#${e.name}checklist`).on("change",'input[type="checkbox"]',()=>{window.aioseoBus.$emit("updateSelectedTerms")}),s(`#${e.name}checklist`).on("wpListAddEnd",()=>{window.aioseoBus.$emit("updateSelectedTerms")})}(window.jQuery)}));const h=e=>{if(!e)return;const t=e.getAttribute("taxonomy");let o=b({...re,name:"Standalone/PrimaryTerm"},{taxonomy:t});o=E(o),o=$(o),o=k(o),T(o),o.mount(e)};if(V()&&window.aioseo&&window.aioseo.currentPost&&window.aioseo.currentPost.context==="post"){const e=document.getElementsByClassName("aioseo-primary-term-app");Array.prototype.forEach.call(e,t=>h(t)),L(".aioseo-primary-term-app","aioseoPrimaryTerm"),document.addEventListener("animationstart",function(t){t.animationName==="aioseoPrimaryTerm"&&h(t.target)},{passive:!0})}
