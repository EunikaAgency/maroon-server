import{G as B}from"./constants.231c2da8.js";import{m as j,a as M,p as E,v as w,o as V,b as H}from"./index.1e998b9c.js";import{u as F}from"./ScrollTo.81bea8a7.js";import{u as v}from"./SeoSiteScore.835c94c8.js";import{j as G,q as W}from"./helpers.1548cd59.js";import{C as q,a as K}from"./Score.f042c135.js";import{C as Y}from"./Blur.f5469924.js";import{C as x}from"./Card.3b9cebd5.js";import{o as i,d as c,H as m,w as h,c as k,r as J,u,x as T,e as y,t as f,a as L,b as g,l as Q,y as n,G as X,N as Z}from"./runtime-dom.esm-bundler.d8b05b6d.js";import{i as $,_ as ee}from"./iphone-frame.e7be06d4.js";import{g as te}from"./utils.5abe120b.js";import{C as oe}from"./DonutChartWithLegend.f7d49fb6.js";import{S as se}from"./Refresh.a0b52b84.js";import"./translations.d159963e.js";import{_ as O}from"./_plugin-vue_export-helper.eefbdd86.js";import{_ as a,s as U}from"./default-i18n.20001971.js";import{S as re}from"./index.42716f2e.js";import"./Tooltip.e34dd010.js";import"./Caret.6651fe3d.js";import"./Slide.53cdbff7.js";import"./SchemaStore.4e47c783.js";import"./metabox.61ec24b3.js";import"./cleanForSlug.5f70afb0.js";import"./deburr.360ac11a.js";import"./toString.569e8443.js";import"./html.3c982da3.js";import"./contentHasAssets.e1428256.js";import"./_baseSet.bcc51cfa.js";import"./regex.8a6101c0.js";import"./GoogleSearchPreview.4ac05671.js";import"./Url.54b4a307.js";import"./Information.5f425594.js";import"./DonutChart.2a6a4bf7.js";import"./AnimatedNumber.da8dc531.js";import"./numbers.9fc174f3.js";import"./Loading.2c3acbc7.js";const ie={key:0,class:"aioseo-seo-site-score-cta"},ne=["href"],ae={__name:"CompetitorSiteHeader",setup(e){const{strings:t}=v(),o=j(),r=M();return(s,l)=>(i(),c("div",null,[m(u(x),{slug:"analyzeNewCompetitor","hide-header":"","no-slide":"",toggles:!1},{default:h(()=>[(i(),k(J(u(o).isUnlicensed?u(Y):"div"),null,{default:h(()=>[T(s.$slots,"default")]),_:3})),u(o).isUnlicensed?(i(),c("div",ie,[y("a",{href:u(r).aioseo.urls.aio.settings},f(u(t).enterLicenseKey),9,ne),L(" "+f(u(t).toAnalyzeCompetitorSite),1)])):g("",!0)]),_:3}),u(o).isUnlicensed?g("",!0):T(s.$slots,"competitor-results",{key:0})]))}},b="all-in-one-seo-pack",le={setup(e){const{description:t,strings:o}=v({score:Q(e.score)});return{analyzerStore:E(),composableStrings:o,description:t,iphoneFrame:$,getAssetUrl:G}},components:{CoreDonutChartWithLegend:oe,SvgRefresh:se},props:{score:Number,loading:Boolean,site:{type:String,required:!0},summary:{type:Object,default(){return{}}},mobileSnapshot:String},data(){return{isAnalyzing:!1,strings:w(this.composableStrings,{refreshResults:a("Refresh Results",b),mobileSnapshot:a("Mobile Snapshot",b),analyzing:a("Analyzing...",b)})}},computed:{sortedParts(){const e=this.summary.good||0,t=this.summary.recommended||0,o=this.summary.critical||0,r=e+t+o;return te({good:e,warnings:t,issues:o,total:r},"competitor",!1)}},methods:{refresh(){this.isAnalyzing=!0,this.analyzerStore.runSiteAnalyzer({url:this.site,refresh:!0}).then(()=>{this.isAnalyzing=!1,this.$emit("refresh")})}}},ce={class:"aioseo-site-score-competitor"},me={class:"aioseo-seo-site-score-score"},pe={key:0,class:"mobile-snapshot"},ue={class:"mobile-snapshot-image"},he=["src"],ye=["src"];function de(e,t,o,r,s,l){const S=n("core-donut-chart-with-legend"),z=n("svg-refresh"),C=n("base-button");return i(),c("div",ce,[y("div",me,[m(S,{parts:l.sortedParts,total:parseInt(o.score),label:r.description,maxTotal:"100",loading:s.isAnalyzing||o.loading,loadingText:s.strings.analyzing},null,8,["parts","total","label","loading","loadingText"])]),m(C,{class:"refresh-results",type:"gray",size:"small",onClick:l.refresh,loading:s.isAnalyzing},{default:h(()=>[m(z),L(" "+f(s.strings.refreshResults),1)]),_:1},8,["onClick","loading"]),o.mobileSnapshot?(i(),c("div",pe,[y("div",null,f(s.strings.mobileSnapshot),1),y("div",ue,[y("img",{class:"mobile-snapshot-image__frame",src:r.getAssetUrl(r.iphoneFrame),alt:"Mobile Snapshot iPhone Frame"},null,8,he),y("img",{class:"mobile-snapshot-image__content",alt:"Mobile Snapshot",src:o.mobileSnapshot},null,8,ye)])])):g("",!0)])}const _e=O(le,[["render",de]]),_="all-in-one-seo-pack",ge={setup(){const{strings:e}=v(),{scrollTo:t}=F();return{analyzerStore:E(),settingsStore:V(),composableStrings:e,scrollTo:t}},components:{CoreAnalyze:q,CoreAnalyzeScore:K,CoreAnalyzeCompetitorSiteHeader:ae,CoreCard:x,CoreSeoSiteAnalysisResults:ee,CoreSiteScoreCompetitor:_e,SvgTrash:re},data(){return{competitorUrl:null,isAnalyzing:!1,inputError:!1,competitorResults:{},analyzeTime:8,strings:w(this.composableStrings,{enterCompetitorUrl:a("Enter Competitor URL",_),performInDepthAnalysis:a("Perform in-depth SEO Analysis of your competitor's website.",_),analyze:a("Analyze",_),pleaseEnterValidUrl:a("Please enter a valid URL.",_)})}},watch:{"analyzerStore.analyzeError"(e){e&&(this.isAnalyzing=!1)}},computed:{getError(){switch(this.analyzerStore.analyzeError){case"invalid-url":return a("The URL provided is invalid.",_);case"missing-content":return U("%1$s %2$s",a("We were unable to parse the content for this site.",_),H.getDocLink(B.learnMore,"seoAnalyzerIssues",!0));case"invalid-token":return U(a("Your site is not connected. Please connect to %1$s, then try again.",_),"AIOSEO")}return this.analyzerStore.analyzeError}},methods:{getSummary(e){return{recommended:this.analyzerStore.recommendedCount("competitor",e),critical:this.analyzerStore.criticalCount("competitor",e),good:this.analyzerStore.goodCount("competitor",e)}},startAnalyzing(e){if(this.inputError=!1,this.competitorUrl=e,!this.competitorUrl.startsWith("http://")&&!this.competitorUrl.startsWith("https")&&(this.competitorUrl="https://"+this.competitorUrl),!W(this.competitorUrl)){this.inputError=!0;return}this.analyzerStore.analyzeError=!1,this.analyzerStore.runSiteAnalyzer({url:this.competitorUrl}),this.isAnalyzing=!0,setTimeout(this.checkStatus,this.analyzeTime*1e3),this.closeAllCards()},checkStatus(){if(this.isAnalyzing=!1,this.analyzerStore.analyzing){this.$nextTick(()=>{this.isAnalyzing=!0,2>this.analyzeTime&&(this.analyzeTime=8),this.analyzeTime=this.analyzeTime/2,setTimeout(this.checkStatus,this.analyzeTime*1e3)});return}this.$nextTick(async()=>{this.competitorResults=await this.analyzerStore.getCompetitorSiteAnalysisResults();const e=Object.keys(this.competitorResults),t=e.indexOf(this.competitorUrl)===-1?0:e.indexOf(this.competitorUrl);this.toggleCard(t),this.scrollTo("aioseo-competitor-results"+this.hashCode(e[t])),this.competitorUrl=null})},startDeleteSite(e){this.closeAllCards(),delete this.competitorResults[e],this.analyzerStore.deleteCompetitorSite(e)},closeAllCards(){Object.keys(this.competitorResults).forEach(t=>{this.settingsStore.closeCard("analyzeCompetitorSite"+t)})},toggleCard(e){const t=Object.keys(this.competitorResults);this.settingsStore.toggleCard({slug:"analyzeCompetitorSite"+t[e]})},hashCode(e){if(!e)return;let t=0,o,r;for(o=0;o<e.length;o++)r=e.charCodeAt(o),t=(t<<5)-t+r,t|=0;return t},async refresh(){this.competitorResults=await this.analyzerStore.getCompetitorSiteAnalysisResults()}},async mounted(){var t,o;this.analyzerStore.analyzeError=!1,this.competitorResults=this.analyzerStore.competitors;const e=Object.keys(this.competitorResults);(o=(t=this.settingsStore)==null?void 0:t.settings)!=null&&o.toggledCards[`analyzeCompetitorSite${e[0]}`]||this.toggleCard(0)}},fe={class:"aioseo-analyze-competitor-site"},Se={key:0,class:"aioseo-description aioseo-error"},ze=["innerHTML"],Ce={class:"competitor-results-main"},Ae={key:0,class:"competitor-results-body"};function be(e,t,o,r,s,l){const S=n("core-analyze"),z=n("core-analyze-score"),C=n("svg-trash"),I=n("core-site-score-competitor"),D=n("core-seo-site-analysis-results"),N=n("core-card"),P=n("core-analyze-competitor-site-header");return i(),c("div",fe,[m(P,null,{"competitor-results":h(()=>[(i(!0),c(X,null,Z(s.competitorResults,(d,p)=>(i(),k(N,{key:p,id:"aioseo-competitor-results"+l.hashCode(p),slug:"analyzeCompetitorSite"+p,"save-toggle-status":!1,class:"aioseo-competitor-results-wrapper"},{header:h(()=>[m(z,{score:parseInt(d.score)},null,8,["score"]),y("span",null,f(p),1),s.isAnalyzing?g("",!0):(i(),k(C,{key:0,onClick:A=>l.startDeleteSite(p)},null,8,["onClick"]))]),default:h(()=>{var A,R;return[y("div",Ce,[m(I,{site:p,score:parseInt(d.score),loading:r.analyzerStore.analyzing,summary:l.getSummary(p),"mobile-snapshot":(R=(A=d.results)==null?void 0:A.advanced)==null?void 0:R.mobileSnapshot,onRefresh:l.refresh},null,8,["site","score","loading","summary","mobile-snapshot","onRefresh"]),d!=null&&d.results?(i(),c("div",Ae,[m(D,{section:"all",site:p,"all-results":d.results,"show-google-preview":""},null,8,["site","all-results"])])):g("",!0)])]}),_:2},1032,["id","slug"]))),128))]),default:h(()=>[m(S,{header:s.strings.enterCompetitorUrl,description:s.strings.performInDepthAnalysis,inputError:s.inputError,isAnalyzing:s.isAnalyzing,analyzeTime:s.analyzeTime,placeholder:"https://competitorwebsite.com",onStartAnalyzing:l.startAnalyzing},{errors:h(()=>[s.inputError?(i(),c("div",Se,f(s.strings.pleaseEnterValidUrl),1)):g("",!0),r.analyzerStore.analyzer==="competitor-site"&&r.analyzerStore.analyzeError?(i(),c("div",{key:1,class:"analyze-errors aioseo-description aioseo-error",innerHTML:r.analyzerStore.analyzeError},null,8,ze)):g("",!0)]),_:1},8,["header","description","inputError","isAnalyzing","analyzeTime","onStartAnalyzing"])]),_:1})])}const nt=O(ge,[["render",be]]);export{nt as default};
